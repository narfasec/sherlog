# Sherlog
<img src="https://www.clipartmax.com/png/middle/286-2860475_sherlock-holmes-silhouette-chess-knight-icon-png.png" width="250" height="250">
<div class="css-thlpjf" style="background-color: rgb(17, 45, 78);"><svg id="105163534" viewBox="0 0 320 99.75689000168512" height="99.75689000168512" width="320" style="width: 320px; height: 99.7569px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.4825); z-index: 0; cursor: pointer;"><defs id="SvgjsDefs7302"><linearGradient id="SvgjsLinearGradient7307"><stop id="SvgjsStop7308" stop-color="#6d7cff" offset="0"></stop><stop id="SvgjsStop7309" stop-color="#ff51ff" offset="1"></stop></linearGradient></defs><g id="SvgjsG7303" featurekey="symbolFeature-0" transform="matrix(1.1104692001786958,0,0,1.1104692001786958,-5.439048756623042,-5.552346000893479)" fill="url(#SvgjsLinearGradient7307)"><defs xmlns="http://www.w3.org/2000/svg"></defs><title xmlns="http://www.w3.org/2000/svg">Sea_Things</title><path xmlns="http://www.w3.org/2000/svg" d="M44.47,81.05c-.29.65-.53,1.27-.74,1.83-.84,2.21-1.64,4.29-4.81,4.13q-1.85-.09-3.57-.09c-7.5,0-13.11,1.31-15.65,3.72a4.74,4.74,0,0,0-1,1.28,55.5,55.5,0,0,1,10-1.71A51.15,51.15,0,0,1,38,91l1.17.18.48.07c2.59.39,4.15.63,6.61-3.71,1.09-1.91,1.73-6.8,2.1-11.83-.31.77-.66,1.55-1,2.32A7.75,7.75,0,0,1,44.47,81.05Z" style="fill: none;"></path><path xmlns="http://www.w3.org/2000/svg" d="M56.11,82.92c-.21-.56-.45-1.18-.74-1.83A7.75,7.75,0,0,1,52.53,78c-.38-.78-.73-1.56-1-2.32.37,5,1,9.91,2.1,11.83,2.46,4.34,4,4.1,6.61,3.71l.48-.07L61.85,91a51.93,51.93,0,0,1,8.64-.75h.57a55.49,55.49,0,0,1,10,1.71,4.74,4.74,0,0,0-1-1.28C77.2,87.9,70.2,86.58,60.91,87,57.73,87.21,56.95,85.12,56.11,82.92Z" style="fill: none;"></path><path xmlns="http://www.w3.org/2000/svg" d="M73.92,69c-.8,0-1.51.06-2.09.06h0c-1.94,0-4.67-1.1-6.72-6.32a29.62,29.62,0,0,1-1.58-5.84,1.21,1.21,0,0,1,2.39-.43c.06.27,1.66,6.75,11.42,6.77,6.67,0,10.43-.91,12.62-3.09,1.75-1.74,2.56-4.39,2.56-8.34,0-6.3-4.68-8.23-7.59-8.82,1.55,2.94,3.79,8.19,2.33,11.81a5.6,5.6,0,0,1-4.17,3.34c-3.64.87-6.6.45-8.82-1.25-3.13-2.39-3.61-6.5-3.68-7.51a1.21,1.21,0,0,1,.21-1A25,25,0,0,0,76,33C76,18.89,64.32,7.43,49.93,7.43S23.82,18.89,23.82,33a25,25,0,0,0,5.26,15.38,1.21,1.21,0,0,1,.21,1c-.08,1-.57,5.12-3.68,7.5-2.22,1.7-5.18,2.12-8.82,1.25a5.6,5.6,0,0,1-4.17-3.34C12.41,54.32,11,50.25,14.9,43c-2.91.61-7.55,2.56-7.55,8.8,0,3.95.81,6.6,2.56,8.34,2.19,2.18,6,3.12,12.62,3.09,9.84,0,11.4-6.71,11.42-6.77a1.21,1.21,0,0,1,2.39.43,29.62,29.62,0,0,1-1.58,5.84C32.7,67.95,30,69.05,28,69.05h0c-.59,0-1.29,0-2.09-.06-4.6-.17-12.31-.47-16.16,3.24a7.37,7.37,0,0,0-1.9,3,13.53,13.53,0,0,1,6.82-2.93A71.82,71.82,0,0,1,25,72.26c1.2.05,2.25.1,3,.09,4.92,0,12.33-6.83,12.59-11.56A1.21,1.21,0,0,1,43,60.68c.05.32,1.18,7.94-3.28,13.16-2.62,3.07-6.58,4.63-11.75,4.64h-.19c-6.4,0-13.18.61-14.69,7a27.66,27.66,0,0,1,14.88-4c3.83,0,10.93,0,14.84-2.28l.17-.1a5.5,5.5,0,0,0,2.14-2.21,39.29,39.29,0,0,0,3.5-11.76c0-.74,0-1.28,0-1.55a1.21,1.21,0,0,1,1.06-1.2,1.17,1.17,0,0,1,.37,0,1.21,1.21,0,0,1,1.18,1.21c0,.27,0,.83,0,1.6a39.3,39.3,0,0,0,3.5,11.77,5.5,5.5,0,0,0,2.14,2.21l.16.1c3.91,2.28,11,2.28,14.84,2.28a27.66,27.66,0,0,1,14.88,4c-1.5-6.38-8.29-7-14.69-7h-.19c-5.18,0-9.13-1.57-11.75-4.64C55.64,68.64,56.77,61,56.82,60.71a1.23,1.23,0,0,1,1.26-1,1.21,1.21,0,0,1,1.15,1.15c.26,4.73,7.68,11.53,12.59,11.56.71,0,1.76,0,3-.09a71.94,71.94,0,0,1,10.37.07A13.54,13.54,0,0,1,92,75.29a7.38,7.38,0,0,0-1.9-3C86.23,68.56,78.53,68.85,73.92,69ZM41.74,47.25a2.74,2.74,0,1,1,2.74-2.74A2.74,2.74,0,0,1,41.74,47.25Zm16.38-.12a2.74,2.74,0,1,1,2.74-2.74A2.74,2.74,0,0,1,58.11,47.13Z" style="fill: none;"></path><path xmlns="http://www.w3.org/2000/svg" d="M73.83,66.6c-.77,0-1.45.06-2,.06h0c-1.67,0-3-1.62-3.94-3.61a16,16,0,0,0,9.44,2.65c7.38,0,11.65-1.12,14.34-3.8,2.2-2.2,3.28-5.49,3.28-10.06,0-9.07-8-11.49-12.27-11.51h0a1.21,1.21,0,0,0-1,1.87C83,44.36,86.29,50.68,85,53.92a3.24,3.24,0,0,1-2.49,1.89c-2.88.69-5.16.42-6.77-.81-2.14-1.63-2.62-4.56-2.73-5.55A27.35,27.35,0,0,0,78.47,33c0-15.43-12.8-28-28.54-28S21.39,17.55,21.39,33a27.36,27.36,0,0,0,5.45,16.44c-.11,1-.59,3.93-2.73,5.55-1.61,1.22-3.89,1.49-6.77.81a3.24,3.24,0,0,1-2.49-1.89c-1.31-3.23,2-9.56,3.35-11.72a1.21,1.21,0,0,0-1-1.87h0c-4.24,0-12.26,2.44-12.26,11.51,0,4.57,1.07,7.86,3.28,10.06,2.66,2.66,6.9,3.8,14.15,3.8h.19A16,16,0,0,0,32,63c-1,2-2.26,3.64-4,3.61-.56,0-1.24,0-2-.06-5-.19-13.34-.51-17.94,3.92a10.88,10.88,0,0,0-3.15,8.18,1.21,1.21,0,0,0,2.19.72s3.08-4.11,7.83-4.64a70,70,0,0,1,10-.06c1.23.05,2.3.11,3.08.1,4.13,0,9.2-3.41,12.26-7.45a11.71,11.71,0,0,1-2.39,4.93C35.74,74.76,32.41,76,28,76h-.19c-5.61,0-17.27,0-17.42,12.06a1.22,1.22,0,0,0,2.07.88c.05-.05,5.3-5.05,15.55-5.05,3.54,0,9,0,13.28-1.4-.72,1.82-1,2.12-2.22,2.06-10.09-.51-17.55,1-21,4.29a6.43,6.43,0,0,0-2.14,4.7,1.21,1.21,0,0,0,1.53,1.18c.08,0,7.77-2.08,11.37-2.12a48.4,48.4,0,0,1,8.82.72l1.19.18.46.07c2.85.43,5.8.88,9.09-4.91a17.93,17.93,0,0,0,1.56-5.31,18,18,0,0,0,1.56,5.34c3.29,5.79,6.24,5.35,9.09,4.91l.46-.07,1.2-.18A49,49,0,0,1,71,92.67c3.6,0,11.29,2.1,11.37,2.12a1.21,1.21,0,0,0,1.53-1.18,6.43,6.43,0,0,0-2.14-4.7c-3.46-3.27-10.92-4.8-21-4.29-1.2.06-1.5-.24-2.22-2.06C62.89,84,68.32,84,71.86,84c10.24,0,15.5,5,15.54,5a1.21,1.21,0,0,0,2.07-.88c-.15-12-11.81-12-17.42-12.06h-.19c-4.43,0-7.76-1.28-9.9-3.78a11.68,11.68,0,0,1-2.4-4.93c3.07,4,8.13,7.42,12.26,7.44.78,0,1.84,0,3.08-.1a70.17,70.17,0,0,1,10,.06c4.72.52,7.8,4.6,7.83,4.64a1.21,1.21,0,0,0,2.19-.72,10.88,10.88,0,0,0-3.15-8.18C87.17,66.09,78.82,66.41,73.83,66.6ZM46.25,87.49c-2.46,4.34-4,4.1-6.61,3.71l-.48-.07L38,91a51.15,51.15,0,0,0-9.22-.75,55.5,55.5,0,0,0-10,1.71,4.74,4.74,0,0,1,1-1.28c2.54-2.4,8.14-3.72,15.65-3.72q1.72,0,3.57.09c3.17.16,4-1.93,4.81-4.13.21-.56.45-1.18.74-1.83A7.75,7.75,0,0,0,47.3,78c.38-.78.73-1.56,1-2.32C48,80.69,47.33,85.58,46.25,87.49ZM60.91,87c9.29-.47,16.29.85,19.22,3.62a4.74,4.74,0,0,1,1,1.28,55.49,55.49,0,0,0-10-1.71H70.5a51.93,51.93,0,0,0-8.64.75l-1.18.18-.48.07c-2.59.39-4.15.63-6.61-3.71-1.09-1.91-1.73-6.8-2.1-11.83.31.77.66,1.54,1,2.32a7.75,7.75,0,0,0,2.83,3.06c.29.65.53,1.27.74,1.83C56.95,85.12,57.73,87.21,60.91,87ZM85.16,72.36a71.94,71.94,0,0,0-10.37-.07c-1.2.05-2.25.1-3,.09-4.92,0-12.33-6.83-12.59-11.56a1.21,1.21,0,0,0-1.15-1.15,1.23,1.23,0,0,0-1.26,1c-.05.32-1.18,7.94,3.28,13.16,2.62,3.07,6.58,4.63,11.75,4.64H72c6.4,0,13.18.61,14.69,7a27.66,27.66,0,0,0-14.88-4c-3.83,0-10.93,0-14.84-2.28l-.16-.1a5.5,5.5,0,0,1-2.14-2.21,39.3,39.3,0,0,1-3.5-11.77c0-.77,0-1.33,0-1.6A1.21,1.21,0,0,0,50,62.36a1.17,1.17,0,0,0-.37,0,1.21,1.21,0,0,0-1.06,1.2c0,.27,0,.81,0,1.55a39.29,39.29,0,0,1-3.5,11.76A5.5,5.5,0,0,1,43,79.13l-.17.1c-3.91,2.28-11,2.28-14.84,2.28a27.66,27.66,0,0,0-14.88,4c1.5-6.38,8.29-7,14.69-7H28c5.18,0,9.13-1.57,11.75-4.64C44.19,68.61,43.06,61,43,60.68a1.21,1.21,0,0,0-2.41.12C40.33,65.52,32.92,72.33,28,72.35c-.71,0-1.76,0-3-.09a71.82,71.82,0,0,0-10.37.07,13.53,13.53,0,0,0-6.82,2.93,7.37,7.37,0,0,1,1.9-3C13.6,68.53,21.31,68.82,25.91,69c.8,0,1.51.06,2.09.06h0c1.94,0,4.67-1.1,6.72-6.32a29.62,29.62,0,0,0,1.58-5.84,1.21,1.21,0,0,0-2.39-.43c0,.07-1.58,6.75-11.42,6.77-6.67,0-10.43-.91-12.62-3.09-1.75-1.74-2.56-4.39-2.56-8.34,0-6.24,4.64-8.19,7.55-8.8C11,50.25,12.41,54.32,12.61,54.8a5.6,5.6,0,0,0,4.17,3.34c3.64.87,6.6.45,8.82-1.25,3.11-2.38,3.61-6.47,3.68-7.5a1.21,1.21,0,0,0-.21-1A25,25,0,0,1,23.82,33c0-14.09,11.71-25.55,26.11-25.55S76,18.89,76,33a25,25,0,0,1-5.28,15.4,1.21,1.21,0,0,0-.21,1c.07,1,.56,5.12,3.68,7.51,2.22,1.7,5.19,2.12,8.82,1.25a5.6,5.6,0,0,0,4.17-3.34C88.69,51.22,86.45,46,84.9,43c2.91.59,7.59,2.52,7.59,8.82,0,3.95-.81,6.6-2.56,8.34C87.74,62.36,84,63.3,77.31,63.27c-9.75,0-11.35-6.5-11.42-6.77a1.21,1.21,0,0,0-2.39.43,29.62,29.62,0,0,0,1.58,5.84c2.05,5.22,4.78,6.32,6.72,6.32h0c.59,0,1.29,0,2.09-.06,4.6-.17,12.31-.47,16.16,3.24a7.38,7.38,0,0,1,1.9,3A13.54,13.54,0,0,0,85.16,72.36Z"></path><circle xmlns="http://www.w3.org/2000/svg" cx="41.74" cy="44.51" r="2.74"></circle><circle xmlns="http://www.w3.org/2000/svg" cx="58.11" cy="44.39" r="2.74"></circle></g><g id="SvgjsG7304" featurekey="nameFeature-0" transform="matrix(0.9792400833376105,0,0,0.9792400833376105,118.6290651907539,19.896592906142537)" fill="#ffffff"><path d="M14.08 14.52 c7.04 0 12.56 4.76 12.56 13.36 c0 7.6 -5.72 12.84 -12.68 12.84 c-7.04 0 -12.56 -4.76 -12.56 -13.36 c0 -7.64 5.72 -12.84 12.68 -12.84 z M14.8 38.44 c2.8 0 4 -3.96 4 -9.64 c0 -6.48 -2 -12 -5.36 -12 c-3 0 -4.16 3.92 -4.16 9.6 c0 6.48 1.96 12.04 5.52 12.04 z M47 35.24 c0.92 0 1.32 0.84 0.84 1.6 c-1.68 2.24 -4.24 3.56 -7.52 3.56 c-5.2 0 -11.08 -3.04 -11.08 -10.6 c0 -7.04 5.88 -10.16 10.64 -10.16 c4.72 0 8.68 2.2 8.72 5.72 c0 1.32 -0.72 2.56 -3.12 2.56 c-2.16 0 -3.04 -1.24 -2.92 -2.64 c0.16 -1.72 0.08 -3.56 -2.04 -3.56 c-2.84 0 -3.6 3.48 -3.6 8.2 c0 3.52 0.72 8.44 4.12 8.44 c2.68 0 3.6 -1.2 4 -2.48 c0.16 -0.44 0.48 -0.64 0.84 -0.64 l1.12 0 z M63.72 38.96 c-1.12 0.84 -2.72 1.32 -4.6 1.32 c-4.2 0 -6.64 -2.32 -6.64 -6.96 l0 -11.16 l-1.4 0 c-0.52 0 -0.68 -0.24 -0.68 -0.76 l0 -0.68 c0 -0.52 0.16 -0.76 0.68 -0.76 c3.44 0 4.8 -2.44 5.12 -5.44 l3.44 0 l0 5.44 l3.32 0 c0.52 0 0.68 0.24 0.68 0.76 l0 0.68 c0 0.52 -0.16 0.76 -0.68 0.76 l-3.32 0 l0 11.92 c0 2.08 0.12 3.6 1.76 3.6 c0.64 0 1.64 -0.32 2.32 -0.92 l0 2.2 z M75.32 19.64 c4.48 0 10.44 2.68 10.44 10.16 c0 7.52 -5.96 10.6 -10.48 10.6 c-4.48 0 -10.44 -3.08 -10.44 -10.28 c0 -7.8 5.96 -10.48 10.48 -10.48 z M78.2 31.64 c0 -6.2 -1.28 -9.92 -3.36 -9.92 c-1.76 0 -2.4 2.8 -2.4 6.72 c0 6.04 1.28 9.92 3.36 9.92 c1.88 0 2.4 -2.84 2.4 -6.72 z M107.72000000000001 19.68 c1.36 0 2.2 0.76 2.2 2.52 c0 0.92 0.12 2.56 -1.28 2.56 c-0.52 0 -0.96 -0.24 -1.8 -0.24 c-0.2 0 -0.16 0.16 -0.12 0.32 c0.08 0.36 0.48 0.96 0.48 2.2 c0 4.76 -4.12 6.88 -9.36 6.88 c-2.48 0 -3.76 -0.56 -4.28 -0.56 c-0.24 0 -0.48 0.16 -0.48 0.6 c0 0.6 0.4 1.04 2.16 1.28 l4 0.56 c6.08 0.84 9.24 2.04 9.24 6.16 c0 3.88 -4.8 6.72 -10.88 6.72 c-5.28 0 -9.44 -1.72 -9.44 -4.96 c0 -2.16 1.6 -3.36 3.72 -3.36 c1.24 0 2.76 0.52 2.76 2.04 c0 1.44 -0.4 1.44 -0.4 2.48 c0 0.8 0.84 1.88 3.52 1.88 c2.04 0 4.88 -0.8 4.88 -3.68 c0 -0.8 -0.44 -1.64 -2.24 -2 l-8.76 -1.72 c-2.28 -0.4 -3.48 -1.92 -3.48 -3.8 c0 -1.56 1.04 -3.12 3.4 -3.4 c-1.72 -0.76 -3.08 -2.84 -3.08 -5.12 c0 -4.76 4.16 -7.4 9.32 -7.4 c3.36 0 4.96 0.96 6.68 2.36 c0.52 -1.44 1.56 -2.32 3.24 -2.32 z M97.80000000000001 31.8 c2.04 0 2.4 -2.44 2.4 -4.84 c0 -2.16 -0.28 -5.24 -2.4 -5.24 c-2.16 0 -2.4 3.08 -2.4 5.24 c0 2.4 0.32 4.84 2.4 4.84 z M134.12 34.08 c0 1.6 1.12 1.96 2.68 1.6 l0 1.92 c-4.64 1.2 -7.4 2.96 -8.2 2.96 c-1.24 0 -1.84 -0.84 -1.68 -2.24 l0.48 -2.56 c-0.96 1.72 -3 4.96 -7 4.96 c-2.96 0 -6.56 -1.44 -6.56 -7.24 l0 -10.04 c0 -0.8 -0.32 -1.2 -1.12 -1.16 l-1.2 0.04 l0 -2 l8.16 -0.52 c0.64 -0.04 1.32 0.36 1.32 1.24 l0 11.6 c0 2.56 -0.32 4.96 1.72 4.96 s3.84 -3.92 4.28 -5.04 l0 -9.12 c0 -0.8 -0.4 -1.2 -1.2 -1.16 l-1.12 0.04 l0 -2 l8.12 -0.52 c0.56 -0.04 1.32 0.36 1.32 1.24 l0 13.04 z M157.52 33.8 c0 1.56 1.12 1.96 2.68 1.56 l0 2.24 c-4.64 1.2 -7.24 2.96 -8.24 2.96 c-1.2 0 -1.72 -0.68 -1.6 -2.04 l0.32 -2.84 c-0.76 2.36 -2.16 4.88 -6.12 4.88 c-3.4 0 -6.16 -1.72 -6.16 -5.16 c0 -4.2 3.4 -6.4 11.96 -8.12 l-0.08 -3.72 c-0.08 -1.92 -0.84 -2.2 -1.52 -2.2 c-4.56 0 -1 6.36 -6.52 6.36 c-1.96 0 -2.84 -1.04 -2.84 -2.6 c0 -3.08 4.28 -5.52 9.88 -5.52 c4.12 0 8.24 0.4 8.24 5.04 l0 9.16 z M147.4 37.44 c2 0 2.84 -3.28 2.96 -4.84 l0 -3.64 c-4.44 0.84 -4.88 4.28 -4.88 5.76 c0 1.56 0.72 2.72 1.92 2.72 z M177.52 19.56 c1.88 0 3.48 1.28 3.48 3.28 c0 2.2 -1.96 3 -3.04 3 c-1.76 0 -2.72 -0.92 -3.64 -0.92 c-2.52 0 -2.72 2.76 -2.92 4.08 l0 7.48 c0 1 1 1.32 2.72 1.48 l0 2.04 c-4.12 -0.08 -8.32 -0.08 -12.44 0 l0 -2.04 c1.44 -0.16 2.52 -0.48 2.52 -1.48 l0 -10.08 c0 -1.64 -1.12 -1.88 -2.6 -1.6 l0 -2.04 c4.88 -1.08 7.08 -3.44 8.36 -3.44 c1.16 0 1.6 0.76 1.44 2.08 l-0.6 4.36 c1.48 -4.56 3.68 -6.2 6.72 -6.2 z M203 33.76 c0 1.56 1.08 1.96 2.64 1.56 l0 2.28 c-4.6 1.2 -7.2 2.96 -8.2 2.96 c-1.24 0 -1.76 -0.72 -1.6 -2.12 l0.04 -1 c-0.48 1.56 -1.64 2.96 -4.52 2.96 c-3.96 0 -9.56 -2.92 -9.56 -10.32 c0 -7.16 5.28 -10.44 9.2 -10.44 c2.56 0 4.16 1.44 4.84 2.76 l0 -3.44 c0 -1.64 -1.12 -2.16 -2.6 -1.88 l0 -1.88 c4.88 -1 7.04 -2.84 8.28 -2.84 c1.2 0 1.48 0.6 1.48 1.76 l0 19.64 z M192.92 38.24 c1.56 0 2.52 -1.88 2.92 -4.04 l0 -9.64 c-0.6 -1.28 -2.16 -2.72 -3.64 -2.72 c-2.28 0 -2.96 2.96 -2.96 6.8 c0 6.12 1.6 9.6 3.68 9.6 z"></path></g></svg></div>

## Description
Inspects resources logging status and gives recomendations according to security best practices

Services covered by this tool:
- S3 Buckets
- RDS Databases

To come:
- DynamoDB
- Lambdas
- ELBs

## Setup
Create a role in your environment with the below (example) trust relationship policy and assign the AWS ***SecurityAudit*** permissions

Example:
```
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "Statement1",
            "Effect": "Allow",
            "Principal": {
                "AWS": "YOUR_ACCOUNT_ID"
            },
            "Action": "sts:AssumeRole",
            "Condition": {
                "StringEquals": {
                    "sts:ExternalId": "YOUR_EXTERNAL_ID"
                }
            }
        }
    ]
}
```

Set the environment variables required. Follow next section
## Env variables description

| Variable | Description |
|----------|-------------|
| LOG_LEVEL | Log level required by the app |
| ROLE_NAME | The role name for the app to assume. Must have read only permissions to the services covered by the tool |
| ACCOUNTS_CONFIGURATION | A list of dicts (passed as string) of the accounts id and external ids used by to assume the role (consider passing it with a secret manager tool). When no external Id is configured in the assume role do not pass it. Example: [{'accountId':'18976838763','externalId':'lkjdalkj/9871lklazdlkKLJldn'},{'accountId':'198719871379'}] |
| DB_URL | The Arangodb url. Example http://localhost:8529 |
| DB_NAME | ArangoDB name |
| DB_USERNAME | Arangodb user name |
| DB_PASSWORD | Arangodb password (consider passing it with a secret manager tool) |